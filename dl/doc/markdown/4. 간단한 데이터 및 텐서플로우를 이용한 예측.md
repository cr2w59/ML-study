## 목표

- BMI 지수 = (몸무게 / 키) * 키
- BMI를 이용하여 비만도를 측정
- 알고리즘 SVM을 이용하여 BMI를 학습, 비만도 판정

## 데이터 획득

```python
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
df = pd.read_csv('3_bmi.csv')
```

## 데이터 준비

```python
# 데이터 확인
df.shape, df.columns, df['label'].unique()
df.dtypes
df['height'].max(), df['height'].min(), df['weight'].max(), df['weight'].min()

# 데이터 정규화 -> 무게, 키의 최대치를 기준으로 처리
# 처리된 값을 다시 해당 컬럼에 대입
df['height'] = df['height'] / df['height'].max()
df['weight'] = df['weight'] / df['weight'].max()

# label은 종속변수. 분류를 벡터화해서 처리
# 케이스 총 3개
# thin->[1, 0, 0] / normal->[0, 1, 0] / fat->[0, 0, 1]
tmp = {'thin':np.array([1,0,0]), 'normal':np.array([0,1,0]), 'fat':np.array([0,0,1])}
df['label'] = df['label'].apply(lambda x : tmp[x])

X_train, X_test, y_train, y_test = train_test_split(df[['height', 'weight']], df['label'], test_size=0.25, random_state=0)
```

## 데이터 분석

- 생략

## 머신러닝 모델링(딥러닝, 텐서플로우 사용)

	- 퍼셉트론
	- 각각의 출력값에 대해 가중치 계산, 바이어스(편향, 조정한 값)를 더해서 softmax라는 함수로 적용
	- 해당 이론을 수식으로 정리하여 함수, 데이터 플로우 그래프로 표현
	- y = softmax(Wx + b)

![](C:\Users\admin\Documents\GitHub\pengsoo\dl\data\sm0.png)

![sm1](C:\Users\admin\Documents\GitHub\pengsoo\dl\data\sm1.png)

![sm2](C:\Users\admin\Documents\GitHub\pengsoo\dl\data\sm2.png)

![sm3](C:\Users\admin\Documents\GitHub\pengsoo\dl\data\sm3.png)

```python
import tensorflow as tf
%tensorflow_version 1.x

# input(x): 키, 몸무게
x = tf.placeholder(tf.float32, [None,2])

# 가중치: shape 고려
W = tf.Variable(tf.zeros([2,3]))

# b(bias): 편향값
b = tf.Variable(tf.zeros([3]))

# 데이터 플로우 그래프: y = softmax(Wx+b)
# x: matrix, 2차 행렬, [none, 2]
# 행렬의 곱 (none, 2) * (2, 3) -> (none, 3)
y = tf.nn.softmax(tf.matmul(x,W)+b)

f'{x.shape} X {W.shape} + {b.shape} = {y.shape}'
```



## 시스템 통합

- 산출물 skip

  