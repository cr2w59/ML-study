# 오차 역전파

- Back propagation
- 경사 하강법의 확장 개념

### 오차 수정 비교



- 단일 퍼셉트론에서는 경사 하강법으로 오차가 최소인 점을 찾아 최초 임의의 가중치를 점차 조정해나감
- 다층 퍼셉트론에서는 은닉층으로 인해 출력층에서 거슬러 올라가며 최적화를 진행함 

## 구동 방식

1. 임의의 초기 가중치(`W`)를 준 뒤 결과(`y`)를 계산

2. 계산 결과와 내가 원하는 값 사이의 오차를 구함

3. 경사 하강법을 이용해 바로 앞 가중치를 오차가 작아지는 방향으로(기울기가 0이 되는 방향) 업데이트

4. 최소의 오차를 구할 때까지 위 과정을 반복

   - = 가중치에서 기울기를 빼도 값의 변화가 없을 때까지
     $$
     W(t+1)=Wt-\frac{\partial오차}{\partial W}
     $$

   - 새 가중치`W(t+1)`는 현 가중치`W(t)`에서 가중치에 대한 기울기를 뺀 값



## 오차 역전파를 이용한 신경망 구현

1. 환경 변수 지정: input과 label의 데이터셋, 학습률, 활성화 함수, 가중치 선언
2. 신경망 실행: 초기값을 입력해 활성화 함수와 가중치를 거친 결과값이 나옴
3. 결과를 실제 값과 비교: 오차 측정
4. 은닉층과 출력층의 가중치 수정(반복)
5. 결과 출력

